attack_technique: T1106
display_name: T1106 - Execution through API
atomic_tests:
- name: 'Atomic Test #1 - Execution through API - CreateProcess'
  description: Execute program by leveraging Win32 API's.
  supported_platforms:
  - windows
  input_arguments:
    source_file:
      description: Location of the CSharp source_file
      type: Path
      default: PathToAtomicsFolder\T1106\src\CreateProcess.cs
    output_file:
      description: Location of the payload
      type: Path
      default: '%tmp%\T1106.exe'
  executor:
    command: |
    'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /t:exe /out:#{output_file} #{source_file}'
    %tmp/T1106.exe
    name: command_prompt
